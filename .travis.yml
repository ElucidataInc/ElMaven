matrix:
  include:
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-5
      env:
         - MATRIX_EVAL="CC=gcc-5 && CXX=g++-5"

dist: xenial
language: cpp
compiler: gcc-5

before_install:
  - sudo add-apt-repository --yes ppa:beineri/opt-qt-5.12.3-xenial
  - sudo apt-get update -q
  - sudo apt-get install --yes qt512-meta-minimal qt512script  qt512declarative qt512websockets qt512multimedia
  - sudo apt-get install --yes libsqlite3-dev libboost1.58-all-dev libnetcdf-dev libpulse-dev libgl1-mesa-dev
  - eval "${MATRIX_EVAL}"

sudo: required

script:
  - QT_ENV_SCRIPT=$(find /opt -name 'qt*-env.sh')
  - source $QT_ENV_SCRIPT
  - export QT_SELECT=qt5
  - export CXX="g++-5"
  - export CC="gcc-5"
  - sudo unlink /usr/bin/gcc && sudo ln -s /usr/bin/gcc-5 /usr/bin/gcc
  - sudo unlink /usr/bin/g++ && sudo ln -s /usr/bin/g++-5 /usr/bin/g++
  - g++ -v
  - gcc -v
  - qmake -v
  - qmake CONFIG+=release -o Makefile build.pro
  - make -j4
  - ./bin/MavenTests -xml
